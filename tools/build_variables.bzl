# In both open-source and fbcode builds, these are generated into
# torch/csrc/{autgrad,jit}/generated.i
GENERATED_CPP = [
    "autograd/generated/Functions.cpp",
    "autograd/generated/VariableType_0.cpp",
    "autograd/generated/VariableType_1.cpp",
    "autograd/generated/VariableType_2.cpp",
    "autograd/generated/VariableType_3.cpp",
    "autograd/generated/VariableType_4.cpp",
    "autograd/generated/TraceType_0.cpp",
    "autograd/generated/TraceType_1.cpp",
    "autograd/generated/TraceType_2.cpp",
    "autograd/generated/TraceType_3.cpp",
    "autograd/generated/TraceType_4.cpp",
    "autograd/generated/python_functions.cpp",
    "autograd/generated/python_nn_functions.cpp",
    "autograd/generated/python_fft_functions.cpp",
    "autograd/generated/python_linalg_functions.cpp",
    "autograd/generated/python_torch_functions.cpp",
    "autograd/generated/python_variable_methods.cpp",
]

# NVFuser runtime library
libtorch_nvfuser_runtime_sources = [
    "torch/csrc/jit/codegen/cuda/runtime/block_reduction.cu",
    "torch/csrc/jit/codegen/cuda/runtime/broadcast.cu",
    "torch/csrc/jit/codegen/cuda/runtime/fp16_support.cu",
    "torch/csrc/jit/codegen/cuda/runtime/grid_reduction.cu",
    "torch/csrc/jit/codegen/cuda/runtime/helpers.cu",
    "torch/csrc/jit/codegen/cuda/runtime/random_numbers.cu",
    "torch/csrc/jit/codegen/cuda/runtime/tensor.cu",
]

libtorch_nvfuser_generated_headers = ["{}.h".format(name[36:-3]) for name in libtorch_nvfuser_runtime_sources]

def libtorch_generated_sources(gencode_pattern):
    return [gencode_pattern.format(name) for name in [
        "autograd/generated/Functions.cpp",
        "autograd/generated/VariableType_0.cpp",
        "autograd/generated/VariableType_1.cpp",
        "autograd/generated/VariableType_2.cpp",
        "autograd/generated/VariableType_3.cpp",
        "autograd/generated/VariableType_4.cpp",
        "autograd/generated/TraceType_0.cpp",
        "autograd/generated/TraceType_1.cpp",
        "autograd/generated/TraceType_2.cpp",
        "autograd/generated/TraceType_3.cpp",
        "autograd/generated/TraceType_4.cpp",
    ]]

# copied from https://github.com/pytorch/pytorch/blob/f99a693cd9ff7a9b5fdc71357dac66b8192786d3/aten/src/ATen/core/CMakeLists.txt
jit_core_headers = [
    "torch/csrc/utils/memory.h",
    "torch/csrc/WindowsTorchApiMacro.h",
    "torch/csrc/jit/frontend/source_range.h",
    "torch/csrc/jit/serialization/source_range_serialization.h",
    "torch/csrc/jit/frontend/lexer.h",
    "torch/csrc/jit/frontend/strtod.h",
    "torch/csrc/jit/frontend/parser_constants.h",
    "torch/csrc/jit/frontend/function_schema_parser.h",
    "torch/csrc/jit/frontend/parse_string_literal.h",
    "torch/csrc/jit/frontend/schema_type_parser.h",
    "torch/csrc/jit/frontend/error_report.h",
    "torch/csrc/jit/frontend/tree.h",
    "torch/custom_class.h",
    "torch/custom_class_detail.h",
    "torch/library.h",
]

jit_core_sources = [
    "torch/csrc/jit/frontend/error_report.cpp",
    "torch/csrc/jit/frontend/function_schema_parser.cpp",
    "torch/csrc/jit/frontend/lexer.cpp",
    "torch/csrc/jit/frontend/schema_type_parser.cpp",
    "torch/csrc/jit/frontend/strtod.cpp",
    "torch/csrc/jit/frontend/source_range.cpp",
]

# copied from https://github.com/pytorch/pytorch/blob/0bde610c14b92d351b968a0228df29e92442b1cc/torch/CMakeLists.txt
# There are some common files used in both internal lite-interpreter and full-jit. Making a separate
# list for the shared files.

core_sources_common = [
    "torch/csrc/autograd/profiler_legacy.cpp",
    "torch/csrc/autograd/profiler_kineto.cpp",
    "torch/csrc/autograd/profiler_utils.cpp",
    "torch/csrc/autograd/autograd_meta.cpp",
    "torch/csrc/autograd/forward_grad.cpp",
    "torch/csrc/jit/frontend/edit_distance.cpp",
    "torch/csrc/jit/frontend/string_to_type.cpp",
    "torch/csrc/jit/mobile/type_parser.cpp",
    "torch/csrc/jit/runtime/instruction.cpp",
    "torch/csrc/jit/runtime/jit_exception.cpp",
    "torch/csrc/jit/runtime/operator.cpp",
    "torch/csrc/jit/runtime/print_handler.cpp",
    "torch/csrc/jit/runtime/slice_indices_adjust.cpp",
    "torch/csrc/jit/runtime/register_ops_utils.cpp",
    "torch/csrc/jit/runtime/vararg_functions.cpp",
    "torch/csrc/jit/serialization/unpickler.cpp",
]

libtorch_sources_common = core_sources_common

core_trainer_sources = [
    "torch/csrc/autograd/anomaly_mode.cpp",
    "torch/csrc/autograd/autograd.cpp",
    "torch/csrc/autograd/cpp_hook.cpp",
    "torch/csrc/autograd/custom_function.cpp",
    "torch/csrc/autograd/engine.cpp",
    "torch/csrc/autograd/function.cpp",
    "torch/csrc/autograd/function_hook.cpp",
    "torch/csrc/autograd/functions/accumulate_grad.cpp",
    "torch/csrc/autograd/functions/basic_ops.cpp",
    "torch/csrc/autograd/functions/tensor.cpp",
    "torch/csrc/autograd/functions/utils.cpp",
    "torch/csrc/autograd/input_buffer.cpp",
    "torch/csrc/autograd/record_function_ops.cpp",
    "torch/csrc/autograd/saved_variable.cpp",
    "torch/csrc/autograd/variable.cpp",
    "torch/csrc/jit/frontend/name_mangler.cpp",
    "torch/csrc/jit/ir/type_hashing.cpp",
    "torch/csrc/jit/serialization/pickler.cpp",
    "torch/csrc/jit/serialization/type_name_uniquer.cpp",
]

core_sources_full_mobile = [
    "torch/csrc/jit/api/function_impl.cpp",
    "torch/csrc/jit/api/module.cpp",
    "torch/csrc/jit/api/object.cpp",
    "torch/csrc/jit/backends/backend_detail.cpp",
    "torch/csrc/jit/backends/backend_interface.cpp",
    "torch/csrc/jit/codegen/fuser/codegen.cpp",
    "torch/csrc/jit/codegen/fuser/compiler.cpp",
    "torch/csrc/jit/codegen/fuser/executor.cpp",
    "torch/csrc/jit/codegen/fuser/fallback.cpp",
    "torch/csrc/jit/codegen/fuser/interface.cpp",
    "torch/csrc/jit/codegen/fuser/kernel_cache.cpp",
    "torch/csrc/jit/frontend/builtin_functions.cpp",
    "torch/csrc/jit/frontend/versioned_symbols.cpp",
    "torch/csrc/jit/frontend/canonicalize_modified_loop.cpp",
    "torch/csrc/jit/frontend/convert_to_ssa.cpp",
    "torch/csrc/jit/frontend/exit_transforms.cpp",
    "torch/csrc/jit/frontend/inline_loop_condition.cpp",
    "torch/csrc/jit/frontend/ir_emitter.cpp",
    "torch/csrc/jit/frontend/parser.cpp",
    "torch/csrc/jit/frontend/schema_matching.cpp",
    "torch/csrc/jit/frontend/script_type_parser.cpp",
    "torch/csrc/jit/frontend/sugared_value.cpp",
    "torch/csrc/jit/frontend/tracer.cpp",
    "torch/csrc/jit/ir/alias_analysis.cpp",
    "torch/csrc/jit/ir/attributes.cpp",
    "torch/csrc/jit/ir/constants.cpp",
    "torch/csrc/jit/ir/ir.cpp",
    "torch/csrc/jit/ir/irparser.cpp",
    "torch/csrc/jit/ir/node_hashing.cpp",
    "torch/csrc/jit/ir/scope.cpp",
    "torch/csrc/jit/ir/subgraph_matcher.cpp",
    "torch/csrc/jit/jit_log.cpp",
    "torch/csrc/jit/jit_opt_limit.cpp",
    "torch/csrc/jit/passes/annotate_warns.cpp",
    "torch/csrc/jit/passes/bailout_graph.cpp",
    "torch/csrc/jit/passes/batch_mm.cpp",
    "torch/csrc/jit/passes/canonicalize.cpp",
    "torch/csrc/jit/passes/canonicalize_graph_fuser_ops.cpp",
    "torch/csrc/jit/passes/clear_profiling.cpp",
    "torch/csrc/jit/passes/clear_undefinedness.cpp",
    "torch/csrc/jit/passes/common_subexpression_elimination.cpp",
    "torch/csrc/jit/passes/constant_pooling.cpp",
    "torch/csrc/jit/passes/constant_propagation.cpp",
    "torch/csrc/jit/passes/create_autodiff_subgraphs.cpp",
    "torch/csrc/jit/passes/dead_code_elimination.cpp",
    "torch/csrc/jit/passes/remove_redundant_profiles.cpp",
    "torch/csrc/jit/passes/decompose_ops.cpp",
    "torch/csrc/jit/passes/erase_number_types.cpp",
    "torch/csrc/jit/passes/fixup_trace_scope_blocks.cpp",
    "torch/csrc/jit/passes/freeze_module.cpp",
    "torch/csrc/jit/passes/fuse_linear.cpp",
    "torch/csrc/jit/passes/fuse_relu.cpp",
    "torch/csrc/jit/passes/graph_fuser.cpp",
    "torch/csrc/jit/passes/graph_rewrite_helper.cpp",
    "torch/csrc/jit/passes/guard_elimination.cpp",
    "torch/csrc/jit/passes/hoist_conv_packed_params.cpp",
    "torch/csrc/jit/passes/inline_autodiff_subgraphs.cpp",
    "torch/csrc/jit/passes/inline_forked_closures.cpp",
    "torch/csrc/jit/passes/inline_fork_wait.cpp",
    "torch/csrc/jit/passes/inliner.cpp",
    "torch/csrc/jit/passes/inplace_check.cpp",
    "torch/csrc/jit/passes/insert_guards.cpp",
    "torch/csrc/jit/passes/lift_closures.cpp",
    "torch/csrc/jit/passes/liveness.cpp",
    "torch/csrc/jit/passes/loop_unrolling.cpp",
    "torch/csrc/jit/passes/lower_grad_of.cpp",
    "torch/csrc/jit/passes/lower_tuples.cpp",
    "torch/csrc/jit/passes/normalize_ops.cpp",
    "torch/csrc/jit/passes/peephole_list_idioms.cpp",
    "torch/csrc/jit/passes/peephole_alias_sensitive.cpp",
    "torch/csrc/jit/passes/pass_manager.cpp",
    "torch/csrc/jit/passes/peephole.cpp",
    "torch/csrc/jit/passes/create_functional_graphs.cpp",
    "torch/csrc/jit/passes/remove_mutation.cpp",
    "torch/csrc/jit/passes/prepack_folding.cpp",
    "torch/csrc/jit/passes/fold_conv_bn.cpp",
    "torch/csrc/jit/passes/frozen_conv_folding.cpp",
    "torch/csrc/jit/passes/frozen_graph_optimizations.cpp",
    "torch/csrc/jit/passes/remove_expands.cpp",
    "torch/csrc/jit/passes/remove_dropout.cpp",
    "torch/csrc/jit/passes/requires_grad_analysis.cpp",
    "torch/csrc/jit/passes/shape_analysis.cpp",
    "torch/csrc/jit/passes/specialize_autogradzero.cpp",
    "torch/csrc/jit/passes/update_differentiable_graph_requires_grad.cpp",
    "torch/csrc/jit/passes/subgraph_rewrite.cpp",
    "torch/csrc/jit/passes/tensorexpr_fuser.cpp",
    "torch/csrc/jit/passes/utils/memory_dag.cpp",
    "torch/csrc/jit/passes/utils/subgraph_utils.cpp",
    "torch/csrc/jit/passes/xnnpack_rewrite.cpp",
    "torch/csrc/jit/passes/vulkan_rewrite.cpp",
    "torch/csrc/jit/passes/metal_rewrite.cpp",
    "torch/csrc/jit/passes/quantization/helper.cpp",
    "torch/csrc/jit/passes/quantization/quantization_type.cpp",
    "torch/csrc/jit/passes/quantization/insert_observers.cpp",
    "torch/csrc/jit/passes/quantization/insert_quant_dequant.cpp",
    "torch/csrc/jit/passes/quantization/dedup_module_uses.cpp",
    "torch/csrc/jit/passes/quantization/finalize.cpp",
    "torch/csrc/jit/passes/quantization/fusion_passes.cpp",
    "torch/csrc/jit/python/update_graph_executor_opt.cpp",
    "torch/csrc/jit/runtime/argument_spec.cpp",
    "torch/csrc/jit/runtime/autodiff.cpp",
    "torch/csrc/jit/runtime/graph_executor.cpp",
    "torch/csrc/jit/runtime/interpreter.cpp",
    "torch/csrc/jit/runtime/logging.cpp",
    "torch/csrc/jit/runtime/profiling_graph_executor_impl.cpp",
    "torch/csrc/jit/runtime/profiling_record.cpp",
    "torch/csrc/jit/runtime/symbolic_script.cpp",
    "torch/csrc/jit/serialization/import.cpp",
    "torch/csrc/jit/serialization/import_export_helpers.cpp",
    "torch/csrc/jit/serialization/import_source.cpp",
    "torch/csrc/jit/serialization/pickle.cpp",
    "torch/csrc/jit/serialization/python_print.cpp",
    "torch/csrc/jit/serialization/source_range_serialization.cpp",
    "torch/csrc/jit/tensorexpr/bounds_inference.cpp",
    "torch/csrc/jit/tensorexpr/bounds_overlap.cpp",
    "torch/csrc/jit/tensorexpr/mem_dependency_checker.cpp",
    "torch/csrc/jit/tensorexpr/codegen.cpp",
    "torch/csrc/jit/tensorexpr/eval.cpp",
    "torch/csrc/jit/tensorexpr/expr.cpp",
    "torch/csrc/jit/tensorexpr/hash_provider.cpp",
    "torch/csrc/jit/tensorexpr/ir.cpp",
    "torch/csrc/jit/tensorexpr/ir_mutator.cpp",
    "torch/csrc/jit/tensorexpr/ir_printer.cpp",
    "torch/csrc/jit/tensorexpr/ir_simplifier.cpp",
    "torch/csrc/jit/tensorexpr/ir_visitor.cpp",
    "torch/csrc/jit/tensorexpr/kernel.cpp",
    "torch/csrc/jit/tensorexpr/llvm_codegen.cpp",
    "torch/csrc/jit/tensorexpr/llvm_jit.cpp",
    "torch/csrc/jit/tensorexpr/block_codegen.cpp",
    "torch/csrc/jit/tensorexpr/loopnest.cpp",
    "torch/csrc/jit/tensorexpr/mem_arena.cpp",
    "torch/csrc/jit/tensorexpr/reduction.cpp",
    "torch/csrc/jit/tensorexpr/registerizer.cpp",
    "torch/csrc/jit/tensorexpr/tensor.cpp",
    "torch/csrc/jit/tensorexpr/types.cpp",
    "torch/csrc/jit/tensorexpr/unique_name_manager.cpp",
    "torch/csrc/jit/testing/file_check.cpp",
    "torch/csrc/jit/testing/hooks_for_testing.cpp",
    "torch/csrc/utils/tensor_flatten.cpp",
    "torch/csrc/utils/variadic.cpp",
]

core_sources_full = core_sources_full_mobile + [
    "torch/csrc/jit/runtime/static/fusion.cpp",
    "torch/csrc/jit/runtime/static/impl.cpp",
    "torch/csrc/jit/runtime/static/ops.cpp",
    "torch/csrc/jit/runtime/static/passes.cpp",
]

libtorch_core_sources = sorted(core_sources_common + core_sources_full + core_trainer_sources)

libtorch_distributed_sources = [
    "torch/csrc/distributed/autograd/autograd.cpp",
    "torch/csrc/distributed/autograd/utils.cpp",
    "torch/csrc/distributed/autograd/context/container.cpp",
    "torch/csrc/distributed/autograd/context/context.cpp",
    "torch/csrc/distributed/autograd/engine/dist_engine.cpp",
    "torch/csrc/distributed/autograd/functions/recvrpc_backward.cpp",
    "torch/csrc/distributed/autograd/functions/sendrpc_backward.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/autograd_metadata.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/propagate_gradients_req.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/propagate_gradients_resp.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/cleanup_autograd_context_req.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/cleanup_autograd_context_resp.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/rpc_with_autograd.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/rpc_with_profiling_req.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/rpc_with_profiling_resp.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/rref_backward_req.cpp",
    "torch/csrc/distributed/autograd/rpc_messages/rref_backward_resp.cpp",
    "torch/csrc/distributed/rpc/message.cpp",
    "torch/csrc/distributed/rpc/profiler/remote_profiler_manager.cpp",
    "torch/csrc/distributed/rpc/profiler/server_process_global_profiler.cpp",
    "torch/csrc/distributed/rpc/python_call.cpp",
    "torch/csrc/distributed/rpc/python_remote_call.cpp",
    "torch/csrc/distributed/rpc/python_resp.cpp",
    "torch/csrc/distributed/rpc/request_callback.cpp",
    "torch/csrc/distributed/rpc/request_callback_no_python.cpp",
    "torch/csrc/distributed/rpc/rpc_agent.cpp",
    "torch/csrc/distributed/rpc/rref_context.cpp",
    "torch/csrc/distributed/rpc/rref_impl.cpp",
    "torch/csrc/distributed/rpc/rref_proto.cpp",
    "torch/csrc/distributed/rpc/script_call.cpp",
    "torch/csrc/distributed/rpc/script_remote_call.cpp",
    "torch/csrc/distributed/rpc/script_resp.cpp",
    "torch/csrc/distributed/rpc/torchscript_functions.cpp",
    "torch/csrc/distributed/rpc/types.cpp",
    "torch/csrc/distributed/rpc/utils.cpp",
    "torch/csrc/distributed/rpc/metrics/registry.cpp",
]

jit_sources_full = [
    "torch/csrc/jit/codegen/cuda/interface.cpp",
    "torch/csrc/jit/passes/lower_graph.cpp",
    "torch/csrc/jit/runtime/register_c10_ops.cpp",
    "torch/csrc/jit/runtime/register_prim_ops.cpp",
    "torch/csrc/jit/runtime/register_prim_ops_fulljit.cpp",
    "torch/csrc/jit/runtime/register_special_ops.cpp",
    "torch/csrc/jit/passes/remove_inplace_ops.cpp",
    "torch/csrc/jit/passes/utils/check_alias_annotation.cpp",
]

libtorch_core_jit_sources = sorted(jit_sources_full)

libtorch_header_list = [
    "aten/src/ATen/Formatting.h",
    "aten/src/ATen/Utils.h",
    "aten/src/ATen/CUDAGeneratorImpl.h",
    "aten/src/ATen/TensorOptions.h",
    "aten/src/ATen/TensorUtils.h",
    "aten/src/ATen/MemoryOverlap.h",
    "aten/src/ATen/InitialTensorOptions.h",
    "aten/src/ATen/Version.h",
    "aten/src/ATen/DLConvertor.h",
    "aten/src/ATen/Device.h",
    "aten/src/ATen/core/Dict_inl.h",
    "aten/src/ATen/core/Formatting.h",
    "aten/src/ATen/core/op_registration/op_whitelist.h",
    "aten/src/ATen/core/op_registration/hacky_wrapper_for_legacy_signatures.h",
    "aten/src/ATen/core/op_registration/op_registration.h",
    "aten/src/ATen/core/op_registration/infer_schema.h",
    "aten/src/ATen/core/jit_type_base.h",
    "aten/src/ATen/core/typeid.h",
    "aten/src/ATen/core/rref_interface.h",
    "aten/src/ATen/core/Range.h",
    "aten/src/ATen/core/interned_strings_class.h",
    "aten/src/ATen/core/operator_name.h",
    "aten/src/ATen/core/DeprecatedTypePropertiesRegistry.h",
    "aten/src/ATen/core/Backtrace.h",
    "aten/src/ATen/core/TransformationHelper.h",
    "aten/src/ATen/core/blob.h",
    "aten/src/ATen/core/function_schema.h",
    "aten/src/ATen/core/dispatch/OperatorOptions.h",
    "aten/src/ATen/core/dispatch/RegistrationHandleRAII.h",
    "aten/src/ATen/core/dispatch/ObservedOperators.h",
    "aten/src/ATen/core/dispatch/DispatchKeyExtractor.h",
    "aten/src/ATen/core/dispatch/Dispatcher.h",
    "aten/src/ATen/core/dispatch/CppSignature.h",
    "aten/src/ATen/core/dispatch/OperatorEntry.h",
    "aten/src/ATen/core/MT19937RNGEngine.h",
    "aten/src/ATen/core/aten_interned_strings.h",
    "aten/src/ATen/core/LegacyTypeDispatch.h",
    "aten/src/ATen/core/function_schema_inl.h",
    "aten/src/ATen/core/qualified_name.h",
    "aten/src/ATen/core/UndefinedTensorImpl.h",
    "aten/src/ATen/core/NamedTensor.h",
    "aten/src/ATen/core/Scalar.h",
    "aten/src/ATen/core/functional.h",
    "aten/src/ATen/core/DeprecatedTypeProperties.h",
    "aten/src/ATen/core/interned_strings.h",
    "aten/src/ATen/core/List.h",
    "aten/src/ATen/core/ATenOpList.h",
    "aten/src/ATen/core/Dict.h",
    "aten/src/ATen/core/grad_mode.h",
    "aten/src/ATen/core/DistributionsHelper.h",
    "aten/src/ATen/core/Macros.h",
    "aten/src/ATen/core/VariableHooksInterface.h",
    "aten/src/ATen/core/ScalarType.h",
    "aten/src/ATen/core/Array.h",
    "aten/src/ATen/core/stack.h",
    "aten/src/ATen/core/ATenGeneral.h",
    "aten/src/ATen/core/UnsafeFromTH.h",
    "aten/src/ATen/core/QuantizerBase.h",
    "aten/src/ATen/core/alias_info.h",
    "aten/src/ATen/core/List_inl.h",
    "aten/src/ATen/core/jit_type.h",
    "aten/src/ATen/core/ivalue.h",
    "aten/src/ATen/core/Dimname.h",
    "aten/src/ATen/core/Vitals.h",
    "aten/src/ATen/core/boxing/impl/make_boxed_from_unboxed_functor.h",
    "aten/src/ATen/core/boxing/impl/boxing.h",
    "aten/src/ATen/core/boxing/impl/test_helpers.h",
    "aten/src/ATen/core/boxing/impl/WrapFunctionIntoFunctor.h",
    "aten/src/ATen/core/boxing/impl/WrapFunctionIntoRuntimeFunctor.h",
    "aten/src/ATen/core/boxing/KernelFunction.h",
    "aten/src/ATen/core/boxing/KernelFunction_impl.h",
    "aten/src/ATen/core/builtin_function.h",
    "aten/src/ATen/core/DimVector.h",
    "aten/src/ATen/core/Reduction.h",
    "aten/src/ATen/core/Tensor.h",
    "aten/src/ATen/core/function.h",
    "aten/src/ATen/core/Generator.h",
    "aten/src/ATen/core/PhiloxRNGEngine.h",
    "aten/src/ATen/core/TensorAccessor.h",
    "aten/src/ATen/core/ivalue_inl.h",
    "aten/src/ATen/core/Variadic.h",
    "aten/src/ATen/VmapMode.h",
    "aten/src/ATen/BatchedFallback.h",
    "aten/src/ATen/native/CompositeRandomAccessor.h",
    "aten/src/ATen/native/TensorTransformations.h",
    "aten/src/ATen/native/ComplexHelper.h",
    "aten/src/ATen/native/ConvUtils.h",
    "aten/src/ATen/native/Repeat.h",
    "aten/src/ATen/native/layer_norm.h",
    "aten/src/ATen/native/GridSampler.h",
    "aten/src/ATen/native/TriangularOpsUtils.h",
    "aten/src/ATen/native/UnfoldBackward.h",
    "aten/src/ATen/native/batch_norm.h",
    "aten/src/ATen/native/Unfold3d.h",
    "aten/src/ATen/native/Fill.h",
    "aten/src/ATen/native/LinearAlgebra.h",
    "aten/src/ATen/native/RNN.h",
    "aten/src/ATen/native/Pool.h",
    "aten/src/ATen/native/Cross.h",
    "aten/src/ATen/native/im2col.h",
    "aten/src/ATen/native/DispatchStub.h",
    "aten/src/ATen/native/Unfold2d.h",
    "aten/src/ATen/native/Distance.h",
    "aten/src/ATen/native/FunctionOfAMatrixUtils.h",
    "aten/src/ATen/native/Distributions.h",
    "aten/src/ATen/native/MaxPooling.h",
    "aten/src/ATen/native/metal/MetalTensor.h",
    "aten/src/ATen/native/metal/MetalTensorImpl.h",
    "aten/src/ATen/native/metal/MetalUtils.h",
    "aten/src/ATen/native/metal/MetalShaders.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNNContext.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNN.h",
    "aten/src/ATen/native/metal/mpscnn/MPSImage+Tensor.h",
    "aten/src/ATen/native/metal/mpscnn/tests/MPSCNNTests.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNNClampOp.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNNOps.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNNOp.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNNNeuronOp.h",
    "aten/src/ATen/native/metal/mpscnn/MPSCNNConvOp.h",
    "aten/src/ATen/native/metal/mpscnn/MPSImageWrapper.h",
    "aten/src/ATen/native/metal/MetalConvolution.h",
    "aten/src/ATen/native/metal/MetalPrepackOpContext.h",
    "aten/src/ATen/native/metal/MetalCommandBuffer.h",
    "aten/src/ATen/native/cpu/IsContiguous.h",
    "aten/src/ATen/native/cpu/zmath.h",
    "aten/src/ATen/native/cpu/utils.h",
    "aten/src/ATen/native/cpu/GridSamplerKernel.h",
    "aten/src/ATen/native/cpu/Intrinsics.h",
    "aten/src/ATen/native/cpu/SoftmaxKernel.h",
    "aten/src/ATen/native/cpu/AtomicAddFloat.h",
    "aten/src/ATen/native/cpu/Reduce.h",
    "aten/src/ATen/native/cpu/CatKernel.h",
    "aten/src/ATen/native/cpu/DepthwiseConvKernel.h",
    "aten/src/ATen/native/cpu/DistributionTemplates.h",
    "aten/src/ATen/native/cpu/avx_mathfun.h",
    "aten/src/ATen/native/cpu/Loops.h",
    "aten/src/ATen/native/DilatedConvolutionUtils.h",
    "aten/src/ATen/native/ForeachUtils.h",
    "aten/src/ATen/native/SobolEngineOpsUtils.h",
    "aten/src/ATen/native/ReduceAllOps.h",
    "aten/src/ATen/native/cuda/CompositeRandomAccessor.h",
    "aten/src/ATen/native/cuda/MiscUtils.h",
    "aten/src/ATen/native/cuda/CuFFTPlanCache.h",
    "aten/src/ATen/native/cuda/CuFFTUtils.h",
    "aten/src/ATen/native/cuda/BatchLinearAlgebraLib.h",
    "aten/src/ATen/native/cuda/DistributionTemplates.h",
    "aten/src/ATen/native/cuda/LaunchUtils.h",
    "aten/src/ATen/native/quantized/affine_quantizer.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/softargmax-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/maxpool-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/gavgpool-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/avgpool-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/channel-shuffle-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/clamp-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/max-pooling-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/requantization-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/zip-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/test_utils.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/add-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/lut-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/lut-norm-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/hardswish-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/dwconv-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/clamp-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/tanh-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/global-average-pooling-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/hardsigmoid-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/fully-connected-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/deconvolution-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/convolution-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/rmax-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/vadd-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/average-pooling-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/gemm-microkernel-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/sigmoid-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/test/leaky-relu-operator-tester.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/include/conv_utils.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/include/qnnpack_func.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/include/pytorch_qnnpack.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/deps/clog/include/clog.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/u8maxpool.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/hgemm.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/sgemm.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/u8lut32norm.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/q8gemm.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/pack.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/params.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/assembly.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/x8zip.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/x8lut.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/operator.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/u8rmax.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/q8dwconv.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/q8vadd.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/q8gavgpool.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/common.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/log.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/requantization.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/indirection.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/math.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/sdwconv.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/sconv.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/AlignedAllocator.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/isa-checks.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/requantization-stubs.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/q8avgpool.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/q8conv.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/scalar-utils.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/qnnpack/u8clamp.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/requantization/runtime-neon.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/requantization/runtime-sse2.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/requantization/gemmlowp-scalar.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/requantization/gemmlowp-sse.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack/src/requantization/runtime-assembly.h",
    "aten/src/ATen/native/quantized/cpu/fbgemm_utils.h",
    "aten/src/ATen/native/quantized/cpu/quantized_ops.h",
    "aten/src/ATen/native/quantized/cpu/embedding_packed_params.h",
    "aten/src/ATen/native/quantized/cpu/packed_params.h",
    "aten/src/ATen/native/quantized/cpu/conv_packed_params.h",
    "aten/src/ATen/native/quantized/cpu/qnnpack_utils.h",
    "aten/src/ATen/native/quantized/cpu/init_qnnpack.h",
    "aten/src/ATen/native/quantized/cpu/conv_serialization.h",
    "aten/src/ATen/native/quantized/cpu/qembeddingbag.h",
    "aten/src/ATen/native/quantized/cpu/quant_utils.h",
    "aten/src/ATen/native/quantized/fake_quant_affine.h",
    "aten/src/ATen/native/quantized/affine_quantizer_base.h",
    "aten/src/ATen/native/quantized/Copy.h",
    "aten/src/ATen/native/Lerp.h",
    "aten/src/ATen/native/ReduceOps.h",
    "aten/src/ATen/native/TensorAdvancedIndexing.h",
    "aten/src/ATen/native/UnaryOps.h",
    "aten/src/ATen/native/SortingUtils.h",
    "aten/src/ATen/native/StridedRandomAccessor.h",
    "aten/src/ATen/native/IndexingUtils.h",
    "aten/src/ATen/native/UpSample.h",
    "aten/src/ATen/native/utils/ParamUtils.h",
    "aten/src/ATen/native/utils/ParamsHash.h",
    "aten/src/ATen/native/utils/Factory.h",
    "aten/src/ATen/native/ResizeCommon.h",
    "aten/src/ATen/native/SharedReduceOps.h",
    "aten/src/ATen/native/Resize.h",
    "aten/src/ATen/native/SpectralOpsUtils.h",
    "aten/src/ATen/native/Sorting.h",
    "aten/src/ATen/native/BucketizationUtils.h",
    "aten/src/ATen/native/vol2col.h",
    "aten/src/ATen/native/LossMulti.h",
    "aten/src/ATen/native/TensorDimApply.h",
    "aten/src/ATen/native/vulkan/Vulkan.h",
    "aten/src/ATen/native/vulkan/VulkanOps.h",
    "aten/src/ATen/native/vulkan/VulkanOpaqueTensorImpl.h",
    "aten/src/ATen/native/vulkan/VulkanConvolution.h",
    "aten/src/ATen/native/vulkan/VulkanAten.h",
    "aten/src/ATen/native/vulkan/VulkanCommon.h",
    "aten/src/ATen/native/vulkan/VulkanOpContext.h",
    "aten/src/ATen/native/vulkan/api/Utils.h",
    "aten/src/ATen/native/vulkan/api/Shader.h",
    "aten/src/ATen/native/vulkan/api/Adapter.h",
    "aten/src/ATen/native/vulkan/api/Descriptor.h",
    "aten/src/ATen/native/vulkan/api/Context.h",
    "aten/src/ATen/native/vulkan/api/Cache.h",
    "aten/src/ATen/native/vulkan/api/Runtime.h",
    "aten/src/ATen/native/vulkan/api/api.h",
    "aten/src/ATen/native/vulkan/api/vk_mem_alloc.h",
    "aten/src/ATen/native/vulkan/api/Common.h",
    "aten/src/ATen/native/vulkan/api/Allocator.h",
    "aten/src/ATen/native/vulkan/api/Resource.h",
    "aten/src/ATen/native/vulkan/api/Pipeline.h",
    "aten/src/ATen/native/vulkan/api/Command.h",
    "aten/src/ATen/native/vulkan/ops/Utils.h",
    "aten/src/ATen/native/vulkan/ops/Persistent.h",
    "aten/src/ATen/native/vulkan/ops/Mm.h",
    "aten/src/ATen/native/vulkan/ops/Convolution.h",
    "aten/src/ATen/native/vulkan/ops/Common.h",
    "aten/src/ATen/native/vulkan/ops/Tensor.h",
    "aten/src/ATen/native/vulkan/ops/Copy.h",
    "aten/src/ATen/native/AdaptivePooling.h",
    "aten/src/ATen/native/xnnpack/OpContext.h",
    "aten/src/ATen/native/xnnpack/Engine.h",
    "aten/src/ATen/native/xnnpack/Convolution.h",
    "aten/src/ATen/native/xnnpack/Linear.h",
    "aten/src/ATen/native/xnnpack/Common.h",
    "aten/src/ATen/native/xnnpack/Pooling.h",
    "aten/src/ATen/native/group_norm.h",
    "aten/src/ATen/native/Activation.h",
    "aten/src/ATen/native/Math.h",
    "aten/src/ATen/native/ScatterGatherChecks.h",
    "aten/src/ATen/native/CPUBlas.h",
    "aten/src/ATen/native/CompositeRandomAccessorCommon.h",
    "aten/src/ATen/native/sparse/ParamUtils.h",
    "aten/src/ATen/native/sparse/SparseTensorMath.h",
    "aten/src/ATen/native/BatchLinearAlgebra.h",
    "aten/src/ATen/native/DistributionTemplates.h",
    "aten/src/ATen/native/TensorIterator.h",
    "aten/src/ATen/native/ReduceOpsUtils.h",
    "aten/src/ATen/native/TensorFactories.h",
    "aten/src/ATen/native/mkldnn/Utils.h",
    "aten/src/ATen/native/mkldnn/MKLDNNCommon.h",
    "aten/src/ATen/native/mkldnn/TensorShape.h",
    "aten/src/ATen/native/PointwiseOps.h",
    "aten/src/ATen/native/BinaryOps.h",
    "aten/src/ATen/native/Pow.h",
    "aten/src/ATen/native/im2col_shape_check.h",
    "aten/src/ATen/native/TensorCompare.h",
    "aten/src/ATen/native/LinearAlgebraUtils.h",
    "aten/src/ATen/native/TypeProperties.h",
    "aten/src/ATen/native/Copy.h",
    "aten/src/ATen/native/cudnn/ConvShared.h",
    "aten/src/ATen/native/cudnn/RNNUtils.h",
    "aten/src/ATen/native/TensorIteratorDynamicCasting.h",
    "aten/src/ATen/test/test_assert.h",
    "aten/src/ATen/test/vec256_test_all_types.h",
    "aten/src/ATen/test/rng_test.h",
    "aten/src/ATen/dlpack.h",
    "aten/src/ATen/Config.h",
    "aten/src/ATen/SparseTensorUtils.h",
    "aten/src/ATen/metal/Context.h",
    "aten/src/ATen/Backtrace.h",
    "aten/src/ATen/cpu/vec256/vec256_bfloat16.h",
    "aten/src/ATen/cpu/vec256/vec256_float_neon.h",
    "aten/src/ATen/cpu/vec256/missing_vst1_neon.h",
    "aten/src/ATen/cpu/vec256/vec256_qint.h",
    "aten/src/ATen/cpu/vec256/intrinsics.h",
    "aten/src/ATen/cpu/vec256/functional.h",
    "aten/src/ATen/cpu/vec256/vec256_complex_float.h",
    "aten/src/ATen/cpu/vec256/vec256_double.h",
    "aten/src/ATen/cpu/vec256/vec256_base.h",
    "aten/src/ATen/cpu/vec256/vec256_float.h",
    "aten/src/ATen/cpu/vec256/missing_vld1_neon.h",
    "aten/src/ATen/cpu/vec256/vec256.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_qint32_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_double_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_int16_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_int32_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_quint8_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vsx_helpers.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_float_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_complex_float_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_common_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_qint8_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_complex_double_vsx.h",
    "aten/src/ATen/cpu/vec256/vsx/vec256_int64_vsx.h",
    "aten/src/ATen/cpu/vec256/vec256_int.h",
    "aten/src/ATen/cpu/vec256/vec256_complex_double.h",
    "aten/src/ATen/cpu/FlushDenormal.h",
    "aten/src/ATen/cpu/vml.h",
    "aten/src/ATen/TracerMode.h",
    "aten/src/ATen/Backend.h",
    "aten/src/ATen/PTThreadPool.h",
    "aten/src/ATen/OpaqueTensorImpl.h",
    "aten/src/ATen/LegacyTHFunctionsCPU.h",
    "aten/src/ATen/cuda/nvrtc_stub/ATenNVRTC.h",
    "aten/src/ATen/cuda/CUDADevice.h",
    "aten/src/ATen/cuda/CUDAFuture.h",
    "aten/src/ATen/cuda/CUDAUtils.h",
    "aten/src/ATen/cuda/CUDABlas.h",
    "aten/src/ATen/cuda/CUDAConfig.h",
    "aten/src/ATen/cuda/PinnedMemoryAllocator.h",
    "aten/src/ATen/cuda/CUDAMultiStreamGuard.h",
    "aten/src/ATen/cuda/CUDAEvent.h",
    "aten/src/ATen/cuda/CUDAContext.h",
    "aten/src/ATen/cuda/Exceptions.h",
    "aten/src/ATen/cuda/CUDASolver.h",
    "aten/src/ATen/cuda/CUDAGraph.h",
    "aten/src/ATen/cuda/detail/CUDAHooks.h",
    "aten/src/ATen/cuda/detail/KernelUtils.h",
    "aten/src/ATen/cuda/detail/LazyNVRTC.h",
    "aten/src/ATen/cuda/detail/DeviceThreadHandles.h",
    "aten/src/ATen/cuda/ATenCUDAGeneral.h",
    "aten/src/ATen/quantized/QTensorImpl.h",
    "aten/src/ATen/quantized/Quantizer.h",
    "aten/src/ATen/record_function.h",
    "aten/src/ATen/WrapDimUtils.h",
    "aten/src/ATen/miopen/Utils.h",
    "aten/src/ATen/miopen/Types.h",
    "aten/src/ATen/miopen/Descriptors.h",
    "aten/src/ATen/miopen/miopen-wrapper.h",
    "aten/src/ATen/miopen/Exceptions.h",
    "aten/src/ATen/miopen/Handle.h",
    "aten/src/ATen/Context.h",
    "aten/src/ATen/div_rtn.h",
    "aten/src/ATen/ExpandUtils.h",
    "aten/src/ATen/TypeDefault.h",
    "aten/src/ATen/CPUFixedAllocator.h",
    "aten/src/ATen/NamedTensor.h",
    "aten/src/ATen/Scalar.h",
    "aten/src/ATen/ParallelNativeTBB.h",
    "aten/src/ATen/ArrayRef.h",
    "aten/src/ATen/SequenceNumber.h",
    "aten/src/ATen/MatrixRef.h",
    "aten/src/ATen/NumericUtils.h",
    "aten/src/ATen/ATen.h",
    "aten/src/ATen/TensorNames.h",
    "aten/src/ATen/TensorMeta.h",
    "aten/src/ATen/TensorIndexing.h",
    "aten/src/ATen/Layout.h",
    "aten/src/ATen/SparseTensorImpl.h",
    "aten/src/ATen/detail/CPUGuardImpl.h",
    "aten/src/ATen/detail/CUDAHooksInterface.h",
    "aten/src/ATen/detail/FunctionTraits.h",
    "aten/src/ATen/detail/HIPHooksInterface.h",
    "aten/src/ATen/nnapi/nnapi_wrapper.h",
    "aten/src/ATen/nnapi/nnapi_model_loader.h",
    "aten/src/ATen/nnapi/NeuralNetworks.h",
    "aten/src/ATen/mkl/Limits.h",
    "aten/src/ATen/mkl/Descriptors.h",
    "aten/src/ATen/mkl/Exceptions.h",
    "aten/src/ATen/WrapDimUtilsMulti.h",
    "aten/src/ATen/TensorOperators.h",
    "aten/src/ATen/hip/impl/HIPAllocatorMasqueradingAsCUDA.h",
    "aten/src/ATen/hip/impl/HIPGuardImplMasqueradingAsCUDA.h",
    "aten/src/ATen/hip/impl/HIPCachingAllocatorMasqueradingAsCUDA.h",
    "aten/src/ATen/hip/impl/HIPStreamMasqueradingAsCUDA.h",
    "aten/src/ATen/ScalarType.h",
    "aten/src/ATen/cpp_custom_type_hack.h",
    "aten/src/ATen/VmapTransforms.h",
    "aten/src/ATen/vulkan/Context.h",
    "aten/src/ATen/Storage.h",
    "aten/src/ATen/DeviceGuard.h",
    "aten/src/ATen/ParallelNative.h",
    "aten/src/ATen/Dispatch.h",
    "aten/src/ATen/CPUGeneratorImpl.h",
    "aten/src/ATen/templates/TensorBody.h",
    "aten/src/ATen/templates/MetaFunctions.h",
    "aten/src/ATen/templates/DispatchKeyFunctions.h",
    "aten/src/ATen/templates/RegistrationDeclarations.h",
    "aten/src/ATen/templates/LegacyTHFunctions.h",
    "aten/src/ATen/templates/Functions.h",
    "aten/src/ATen/templates/NativeFunctions.h",
    "aten/src/ATen/ParallelOpenMP.h",
    "aten/src/ATen/BatchedTensorImpl.h",
    "aten/src/ATen/CPUApplyUtils.h",
    "aten/src/ATen/ThreadLocalState.h",
    "aten/src/ATen/ScalarOps.h",
    "aten/src/ATen/DynamicLibrary.h",
    "aten/src/ATen/TensorGeometry.h",
    "aten/src/ATen/TensorIterator.h",
    "aten/src/ATen/NamedTensorUtils.h",
    "aten/src/ATen/Dimname.h",
    "aten/src/ATen/autocast_mode.h",
    "aten/src/ATen/Parallel.h",
    "aten/src/ATen/DimVector.h",
    "aten/src/ATen/InferSize.h",
    "aten/src/ATen/SmallVector.h",
    "aten/src/ATen/Tensor.h",
    "aten/src/ATen/Generator.h",
    "aten/src/ATen/AccumulateType.h",
    "aten/src/ATen/TensorAccessor.h",
    "aten/src/ATen/LegacyTHFunctionsCUDA.h",
    "aten/src/ATen/cudnn/Handles.h",
    "aten/src/ATen/cudnn/Utils.h",
    "aten/src/ATen/cudnn/Types.h",
    "aten/src/ATen/cudnn/Descriptors.h",
    "aten/src/ATen/cudnn/Exceptions.h",
    "aten/src/ATen/cudnn/Handle.h",
    "aten/src/ATen/cudnn/cudnn-wrapper.h",
]

aten_cpu_source_list = [
    "aten/src/ATen/BatchedTensorImpl.cpp",
    "aten/src/ATen/CPUGeneratorImpl.cpp",
    "aten/src/ATen/Context.cpp",
    "aten/src/ATen/DLConvertor.cpp",
    "aten/src/ATen/ExpandUtils.cpp",
    "aten/src/ATen/MemoryOverlap.cpp",
    "aten/src/ATen/NamedTensorUtils.cpp",
    "aten/src/ATen/ParallelCommon.cpp",
    "aten/src/ATen/ParallelNative.cpp",
    "aten/src/ATen/ParallelNativeTBB.cpp",
    "aten/src/ATen/ParallelOpenMP.cpp",
    "aten/src/ATen/ParallelThreadPoolNative.cpp",
    "aten/src/ATen/ScalarOps.cpp",
    "aten/src/ATen/SequenceNumber.cpp",
    "aten/src/ATen/SparseTensorImpl.cpp",
    "aten/src/ATen/SparseTensorUtils.cpp",
    "aten/src/ATen/TensorGeometry.cpp",
    "aten/src/ATen/TensorIndexing.cpp",
    "aten/src/ATen/TensorMeta.cpp",
    "aten/src/ATen/TensorNames.cpp",
    "aten/src/ATen/TensorUtils.cpp",
    "aten/src/ATen/ThreadLocalState.cpp",
    "aten/src/ATen/Utils.cpp",
    "aten/src/ATen/Version.cpp",
    "aten/src/ATen/VmapMode.cpp",
    "aten/src/ATen/VmapTransforms.cpp",
    "aten/src/ATen/core/BackendSelectFallbackKernel.cpp",
    "aten/src/ATen/core/DeprecatedTypeProperties.cpp",
    "aten/src/ATen/core/DeprecatedTypePropertiesRegistry.cpp",
    "aten/src/ATen/core/Dict.cpp",
    "aten/src/ATen/core/Dimname.cpp",
    "aten/src/ATen/core/Formatting.cpp",
    "aten/src/ATen/core/Generator.cpp",
    "aten/src/ATen/core/List.cpp",
    "aten/src/ATen/core/NamedTensor.cpp",
    "aten/src/ATen/core/Tensor.cpp",
    "aten/src/ATen/core/VariableFallbackKernel.cpp",
    "aten/src/ATen/core/VariableHooksInterface.cpp",
    "aten/src/ATen/core/boxing/KernelFunction.cpp",
    "aten/src/ATen/core/custom_class.cpp",
    "aten/src/ATen/core/dispatch/DispatchKeyExtractor.cpp",
    "aten/src/ATen/core/dispatch/Dispatcher.cpp",
    "aten/src/ATen/core/dispatch/ObservedOperators.cpp",
    "aten/src/ATen/core/dispatch/OperatorEntry.cpp",
    "aten/src/ATen/core/grad_mode.cpp",
    "aten/src/ATen/core/interned_strings.cpp",
    "aten/src/ATen/core/ivalue.cpp",
    "aten/src/ATen/core/library.cpp",
    "aten/src/ATen/core/op_registration/infer_schema.cpp",
    "aten/src/ATen/core/op_registration/op_registration.cpp",
    "aten/src/ATen/core/operator_name.cpp",
    "aten/src/ATen/core/register_symbols.cpp",
    "aten/src/ATen/core/type.cpp",
    "aten/src/ATen/cpu/FlushDenormal.cpp",
    "aten/src/ATen/detail/CPUGuardImpl.cpp",
    "aten/src/ATen/detail/CUDAHooksInterface.cpp",
    "aten/src/ATen/detail/HIPHooksInterface.cpp",
    "aten/src/ATen/metal/Context.cpp",
    "aten/src/ATen/native/AutogradComposite.cpp",
    "aten/src/ATen/native/BatchLinearAlgebraKernel.cpp",
    "aten/src/ATen/native/DispatchStub.cpp",
    "aten/src/ATen/native/UpSample.cpp",
    "aten/src/ATen/native/cpu/AdaptiveAvgPoolKernel.cpp",
    "aten/src/ATen/native/mkl/LinearAlgebra.cpp",
    "aten/src/ATen/native/mkl/SpectralOps.cpp",
    "aten/src/ATen/native/mkldnn/BinaryOps.cpp",
    "aten/src/ATen/native/mkldnn/Conv.cpp",
    "aten/src/ATen/native/mkldnn/IDeepRegistration.cpp",
    "aten/src/ATen/native/mkldnn/Linear.cpp",
    "aten/src/ATen/native/mkldnn/MKLDNNCommon.cpp",
    "aten/src/ATen/native/mkldnn/MKLDNNConversions.cpp",
    "aten/src/ATen/native/mkldnn/MkldnnTensorMath.cpp",
    "aten/src/ATen/native/mkldnn/Normalization.cpp",
    "aten/src/ATen/native/mkldnn/Pooling.cpp",
    "aten/src/ATen/native/mkldnn/Relu.cpp",
    "aten/src/ATen/native/mkldnn/SoftMax.cpp",
    "aten/src/ATen/native/mkldnn/TensorFactories.cpp",
    "aten/src/ATen/native/mkldnn/TensorShape.cpp",
    "aten/src/ATen/native/mkldnn/UnaryOps.cpp",
    "aten/src/ATen/native/mkldnn/Utils.cpp",
    "aten/src/ATen/native/quantized/cpu/init_qnnpack.cpp",
    "aten/src/ATen/record_function.cpp",
    "aten/src/ATen/vulkan/Context.cpp",
]

# Files in ATen/native with a few exceptions
# TODO: move the exceptions to proper locations
aten_native_source_list = [
    "aten/src/ATen/native/RNN.cpp",
    "aten/src/ATen/native/quantized/cpu/fbgemm_utils.cpp",
    "aten/src/ATen/native/quantized/cpu/int_repr_quant.cpp",
    "aten/src/ATen/native/quantized/cpu/make_per_tensor_quantized_tensor.cpp",
    "aten/src/ATen/native/quantized/cpu/q_adaavgpool.cpp",
    "aten/src/ATen/native/quantized/cpu/q_avgpool.cpp",
    "aten/src/ATen/native/quantized/cpu/q_avgpool3d.cpp",
    "aten/src/ATen/native/quantized/cpu/qadd.cpp",
    "aten/src/ATen/native/quantized/cpu/qbatch_norm.cpp",
    "aten/src/ATen/native/quantized/cpu/qchannel_shuffle.cpp",
    "aten/src/ATen/native/quantized/cpu/qclamp.cpp",
    "aten/src/ATen/native/quantized/cpu/qconcat.cpp",
    "aten/src/ATen/native/quantized/cpu/qconv.cpp",
    "aten/src/ATen/native/quantized/cpu/qconv_prepack.cpp",
    "aten/src/ATen/native/quantized/cpu/qconv_unpack.cpp",
    "aten/src/ATen/native/quantized/cpu/qelu.cpp",
    "aten/src/ATen/native/quantized/cpu/qembeddingbag.cpp",
    "aten/src/ATen/native/quantized/cpu/qembeddingbag_prepack.cpp",
    "aten/src/ATen/native/quantized/cpu/qembeddingbag_unpack.cpp",
    "aten/src/ATen/native/quantized/cpu/qhardsigmoid.cpp",
    "aten/src/ATen/native/quantized/cpu/qhardswish.cpp",
    "aten/src/ATen/native/quantized/cpu/qlinear.cpp",
    "aten/src/ATen/native/quantized/cpu/qlinear_dynamic.cpp",
    "aten/src/ATen/native/quantized/cpu/qlinear_prepack.cpp",
    "aten/src/ATen/native/quantized/cpu/qlinear_unpack.cpp",
    "aten/src/ATen/native/quantized/cpu/qmul.cpp",
    "aten/src/ATen/native/quantized/cpu/qnormalization.cpp",
    "aten/src/ATen/native/quantized/cpu/qpool.cpp",
    "aten/src/ATen/native/quantized/cpu/qreduction.cpp",
    "aten/src/ATen/native/quantized/cpu/qrelu.cpp",
    "aten/src/ATen/native/quantized/cpu/qsigmoid.cpp",
    "aten/src/ATen/native/quantized/cpu/qsort.cpp",
    "aten/src/ATen/native/quantized/cpu/qtanh.cpp",
    "aten/src/ATen/native/quantized/cpu/qthreshold.cpp",
    "aten/src/ATen/native/quantized/cpu/qupsample_bilinear2d.cpp",
    "aten/src/ATen/native/quantized/cpu/qupsample_nearest2d.cpp",
    "aten/src/ATen/native/quantized/cpu/qupsample_nearest3d.cpp",
    "aten/src/ATen/native/quantized/cpu/tensor_operators.cpp",
    "aten/src/ATen/native/quantized/Copy.cpp",
    "aten/src/ATen/native/quantized/QTensor.cpp",
    "aten/src/ATen/native/quantized/TensorCompare.cpp",
    "aten/src/ATen/native/quantized/TensorFactories.cpp",
    "aten/src/ATen/native/quantized/affine_quantizer.cpp",
    "aten/src/ATen/native/quantized/affine_quantizer_base.cpp",
    "aten/src/ATen/native/quantized/fake_quant_per_channel_affine.cpp",
    "aten/src/ATen/native/quantized/fake_quant_per_tensor_affine.cpp",
    "aten/src/ATen/native/quantized/library.cpp",
    "aten/src/ATen/quantized/QTensorImpl.cpp",
    "aten/src/ATen/quantized/Quantizer.cpp",
    "aten/src/ATen/native/Activation.cpp",
    "aten/src/ATen/native/AdaptiveAveragePooling.cpp",
    "aten/src/ATen/native/AdaptiveAveragePooling3d.cpp",
    "aten/src/ATen/native/AdaptiveMaxPooling2d.cpp",
    "aten/src/ATen/native/AdaptiveMaxPooling3d.cpp",
    "aten/src/ATen/native/AffineGridGenerator.cpp",
    "aten/src/ATen/native/AveragePool2d.cpp",
    "aten/src/ATen/native/AveragePool3d.cpp",
    "aten/src/ATen/native/BatchLinearAlgebra.cpp",
    "aten/src/ATen/native/Batching.cpp",
    "aten/src/ATen/native/BinaryOps.cpp",
    "aten/src/ATen/native/Blas.cpp",
    "aten/src/ATen/native/BlasKernel.cpp",
    "aten/src/ATen/native/Bucketization.cpp",
    "aten/src/ATen/native/CPUBlas.cpp",
    "aten/src/ATen/native/ChanelShuffle.cpp",
    "aten/src/ATen/native/Col2Im.cpp",
    "aten/src/ATen/native/ConstantPadNd.cpp",
    "aten/src/ATen/native/Convolution.cpp",
    "aten/src/ATen/native/ConvolutionMM2d.cpp",
    "aten/src/ATen/native/ConvolutionMM3d.cpp",
    "aten/src/ATen/native/ConvolutionTBC.cpp",
    "aten/src/ATen/native/Copy.cpp",
    "aten/src/ATen/native/Cross.cpp",
    "aten/src/ATen/native/DilatedMaxPool2d.cpp",
    "aten/src/ATen/native/DilatedMaxPool3d.cpp",
    # Referenced by both native and ATen/Version.cpp. Does not reference to other native symbols
    # "aten/src/ATen/native/DispatchStub.cpp",
    # "aten/src/ATen/native/quantized/cpu/init_qnnpack.cpp",
    "aten/src/ATen/native/Distance.cpp",
    "aten/src/ATen/native/Distributions.cpp",
    "aten/src/ATen/native/Dropout.cpp",
    "aten/src/ATen/native/Embedding.cpp",
    "aten/src/ATen/native/EmbeddingBag.cpp",
    "aten/src/ATen/native/Fill.cpp",
    "aten/src/ATen/native/ForeachOpsKernels.cpp",
    "aten/src/ATen/native/FractionalMaxPool2d.cpp",
    "aten/src/ATen/native/FractionalMaxPool3d.cpp",
    "aten/src/ATen/native/FunctionOfAMatrixUtils.cpp",
    "aten/src/ATen/native/GatedLinearUnit.cpp",
    "aten/src/ATen/native/GridSampler.cpp",
    "aten/src/ATen/native/Im2Col.cpp",
    "aten/src/ATen/native/IndexingUtils.cpp",
    "aten/src/ATen/native/Integration.cpp",
    "aten/src/ATen/native/Itertools.cpp",
    "aten/src/ATen/native/LegacyBridge.cpp",
    "aten/src/ATen/native/LegacyDefinitions.cpp",
    "aten/src/ATen/native/LegacyNNDefinitions.cpp",
    "aten/src/ATen/native/Lerp.cpp",
    "aten/src/ATen/native/Linear.cpp",
    "aten/src/ATen/native/LinearAlgebra.cpp",
    "aten/src/ATen/native/Loss.cpp",
    "aten/src/ATen/native/LossCTC.cpp",
    "aten/src/ATen/native/LossMultiLabelMargin.cpp",
    "aten/src/ATen/native/LossMultiMargin.cpp",
    "aten/src/ATen/native/LossNLL.cpp",
    "aten/src/ATen/native/LossNLL2d.cpp",
    "aten/src/ATen/native/MaxPooling.cpp",
    "aten/src/ATen/native/MaxUnpooling.cpp",
    "aten/src/ATen/native/Memory.cpp",
    "aten/src/ATen/native/MetaTensor.cpp",
    "aten/src/ATen/native/NNPACK.cpp",
    "aten/src/ATen/native/NaiveConvolutionTranspose2d.cpp",
    "aten/src/ATen/native/NaiveConvolutionTranspose3d.cpp",
    "aten/src/ATen/native/NaiveDilatedConvolution.cpp",
    "aten/src/ATen/native/NamedTensor.cpp",
    "aten/src/ATen/native/Normalization.cpp",
    "aten/src/ATen/native/Onehot.cpp",
    "aten/src/ATen/native/PackedSequence.cpp",
    "aten/src/ATen/native/PixelShuffle.cpp",
    "aten/src/ATen/native/PointwiseOps.cpp",
    "aten/src/ATen/native/Pooling.cpp",
    "aten/src/ATen/native/Pow.cpp",
    "aten/src/ATen/native/QuantizedLinear.cpp",
    "aten/src/ATen/native/RNN.cpp",
    "aten/src/ATen/native/RangeFactories.cpp",
    "aten/src/ATen/native/ReduceAllOps.cpp",
    "aten/src/ATen/native/ReduceOps.cpp",
    "aten/src/ATen/native/ReflectionPad.cpp",
    "aten/src/ATen/native/Repeat.cpp",
    "aten/src/ATen/native/ReplicationPadding.cpp",
    "aten/src/ATen/native/Resize.cpp",
    "aten/src/ATen/native/RowwisePrune.cpp",
    "aten/src/ATen/native/Scalar.cpp",
    "aten/src/ATen/native/SobolEngineOps.cpp",
    "aten/src/ATen/native/SobolEngineOpsUtils.cpp",
    "aten/src/ATen/native/SoftMax.cpp",
    "aten/src/ATen/native/Sorting.cpp",
    "aten/src/ATen/native/SpectralOps.cpp",
    "aten/src/ATen/native/SummaryOps.cpp",
    "aten/src/ATen/native/TensorAdvancedIndexing.cpp",
    "aten/src/ATen/native/TensorCompare.cpp",
    "aten/src/ATen/native/TensorConversions.cpp",
    "aten/src/ATen/native/TensorFactories.cpp",
    "aten/src/ATen/native/TensorIteratorReduce.cpp",
    "aten/src/ATen/native/TensorProperties.cpp",
    "aten/src/ATen/native/TensorShape.cpp",
    "aten/src/ATen/native/TensorTransformations.cpp",
    "aten/src/ATen/native/TestOps.cpp",
    "aten/src/ATen/native/TriangularOps.cpp",
    "aten/src/ATen/native/TypeProperties.cpp",
    "aten/src/ATen/native/UnaryOps.cpp",
    "aten/src/ATen/native/Unfold2d.cpp",
    "aten/src/ATen/native/Unfold3d.cpp",
    "aten/src/ATen/native/UnfoldBackward.cpp",
    "aten/src/ATen/native/Unique.cpp",
    # Low-level functions that can be directly referenced
    # "aten/src/ATen/native/UpSample.cpp",
    "aten/src/ATen/native/UpSampleBicubic2d.cpp",
    "aten/src/ATen/native/UpSampleBilinear2d.cpp",
    "aten/src/ATen/native/UpSampleLinear1d.cpp",
    "aten/src/ATen/native/UpSampleNearest1d.cpp",
    "aten/src/ATen/native/UpSampleNearest2d.cpp",
    "aten/src/ATen/native/UpSampleNearest3d.cpp",
    "aten/src/ATen/native/UpSampleTrilinear3d.cpp",
    "aten/src/ATen/native/VariableMethodStubs.cpp",
    "aten/src/ATen/native/WeightNorm.cpp",
    "aten/src/ATen/native/group_norm.cpp",
    "aten/src/ATen/native/layer_norm.cpp",
    "aten/src/ATen/native/cpu/Activation.cpp",
    "aten/src/ATen/native/cpu/BinaryOpsKernel.cpp",
    "aten/src/ATen/native/cpu/BlasKernel.cpp",
    "aten/src/ATen/native/cpu/CatKernel.cpp",
    "aten/src/ATen/native/cpu/ComplexKernel.cpp",
    "aten/src/ATen/native/cpu/CopyKernel.cpp",
    "aten/src/ATen/native/cpu/CrossKernel.cpp",
    "aten/src/ATen/native/cpu/DepthwiseConvKernel.cpp",
    "aten/src/ATen/native/cpu/DistanceOpsKernel.cpp",
    "aten/src/ATen/native/cpu/FillKernel.cpp",
    "aten/src/ATen/native/cpu/FunctionOfAMatrixUtilsKernel.cpp",
    "aten/src/ATen/native/cpu/GridSamplerKernel.cpp",
    "aten/src/ATen/native/cpu/IndexKernel.cpp",
    "aten/src/ATen/native/cpu/LerpKernel.cpp",
    "aten/src/ATen/native/cpu/LinearAlgebraKernel.cpp",
    "aten/src/ATen/native/cpu/MaxPooling.cpp",
    "aten/src/ATen/native/cpu/MultinomialKernel.cpp",
    "aten/src/ATen/native/cpu/PointwiseOpsKernel.cpp",
    "aten/src/ATen/native/cpu/PowKernel.cpp",
    "aten/src/ATen/native/cpu/RangeFactoriesKernel.cpp",
    "aten/src/ATen/native/cpu/ReduceAllOpsKernel.cpp",
    "aten/src/ATen/native/cpu/ReduceOpsKernel.cpp",
    "aten/src/ATen/native/cpu/ScatterGatherKernel.cpp",
    "aten/src/ATen/native/cpu/SoftMaxKernel.cpp",
    "aten/src/ATen/native/cpu/SortingKernel.cpp",
    "aten/src/ATen/native/cpu/SumKernel.cpp",
    "aten/src/ATen/native/cpu/TensorCompareKernel.cpp",
    "aten/src/ATen/native/cpu/UnaryOpsKernel.cpp",
    "aten/src/ATen/native/cpu/Unfold2d.cpp",
    "aten/src/ATen/native/cpu/UnfoldBackwardKernel.cpp",
    "aten/src/ATen/native/cpu/UpSampleKernel.cpp",
    "aten/src/ATen/native/cpu/UpSampleMoreKernel.cpp",
    "aten/src/ATen/native/cpu/batch_norm_kernel.cpp",
    "aten/src/ATen/native/cpu/group_norm_kernel.cpp",
    "aten/src/ATen/native/cpu/layer_norm_kernel.cpp",
    "aten/src/ATen/native/quantized/cpu/kernels/QuantizedOpKernels.cpp",
    "aten/src/ATen/native/sparse/ParamUtils.cpp",
    "aten/src/ATen/native/sparse/SoftMax.cpp",
    "aten/src/ATen/native/sparse/SparseMatMul.cpp",
    "aten/src/ATen/native/sparse/SparseTensor.cpp",
    "aten/src/ATen/native/sparse/SparseTensorMath.cpp",
    "aten/src/TH/THAllocator.cpp",
    "aten/src/TH/THBlas.cpp",
    "aten/src/TH/THGeneral.cpp",
    "aten/src/TH/THLapack.cpp",
    "aten/src/TH/THStorageFunctions.cpp",
    "aten/src/TH/THTensor.cpp",
    "aten/src/TH/THTensorEvenMoreMath.cpp",
    "aten/src/TH/THTensorLapack.cpp",
    "aten/src/TH/THTensorMath.cpp",
    "aten/src/TH/THTensorMoreMath.cpp",
    "aten/src/TH/THTensorRandom.cpp",
    "aten/src/TH/THVector.cpp",
    "aten/src/ATen/native/utils/Factory.cpp",
    "aten/src/ATen/native/xnnpack/ChannelShuffle.cpp",
    "aten/src/ATen/native/xnnpack/Convolution.cpp",
    "aten/src/ATen/native/xnnpack/Init.cpp",
    "aten/src/ATen/native/xnnpack/Linear.cpp",
    "aten/src/ATen/native/xnnpack/MaxPooling.cpp",
    "aten/src/ATen/native/xnnpack/OpContext.cpp",
    "aten/src/ATen/native/xnnpack/RegisterOpContextClass.cpp",
    "aten/src/ATen/native/xnnpack/Shim.cpp",
    # Files not in native, but depends on native symbols
    # "aten/src/ATen/TensorIndexing.cpp",
    "aten/src/ATen/TensorIterator.cpp",
    "aten/src/ATen/LegacyTHFunctionsCPU.cpp",
]

torch_mobile_core = [
    "torch/csrc/jit/mobile/function.cpp",
    "torch/csrc/jit/mobile/import.cpp",
    "torch/csrc/jit/mobile/interpreter.cpp",
    "torch/csrc/jit/mobile/module.cpp",
]

libtorch_lite_cmake_sources = sorted(libtorch_header_list + aten_cpu_source_list + aten_native_source_list + torch_mobile_core)

libtorch_cmake_sources = libtorch_core_sources + libtorch_core_jit_sources

libtorch_extra_sources = libtorch_core_jit_sources + [
    "torch/csrc/autograd/TraceTypeManual.cpp",
    "torch/csrc/autograd/VariableTypeManual.cpp",
    "torch/csrc/autograd/FunctionsManual.cpp",
    "torch/csrc/jit/api/module_save.cpp",
    "torch/csrc/jit/codegen/fuser/cpu/fused_kernel.cpp",
    "torch/csrc/jit/mobile/export_data.cpp",
    "torch/csrc/jit/mobile/function.cpp",
    "torch/csrc/jit/mobile/import.cpp",
    "torch/csrc/jit/mobile/import_data.cpp",
    "torch/csrc/jit/mobile/interpreter.cpp",
    "torch/csrc/jit/mobile/module.cpp",
    "torch/csrc/jit/mobile/observer.cpp",
    "torch/csrc/jit/mobile/optim/sgd.cpp",
    "torch/csrc/jit/mobile/sequential.cpp",
    "torch/csrc/jit/serialization/onnx.cpp",
    "torch/csrc/jit/serialization/export.cpp",
    "torch/csrc/jit/serialization/export_module.cpp",
    "torch/csrc/jit/serialization/import_legacy.cpp",
    "torch/csrc/utils/byte_order.cpp",
    "torch/csrc/utils/out_types.cpp",
]

def libtorch_sources(gencode_pattern = ":generate-code[{}]"):
    return libtorch_generated_sources(gencode_pattern) + libtorch_core_sources + libtorch_distributed_sources + libtorch_extra_sources

libtorch_cuda_core_sources = [
    "torch/csrc/CudaIPCTypes.cpp",
    "torch/csrc/cuda/comm.cpp",
    "torch/csrc/jit/codegen/fuser/cuda/fused_kernel.cpp",
    "torch/csrc/autograd/profiler_cuda.cpp",
    "torch/csrc/autograd/functions/comm.cpp",
    "torch/csrc/jit/codegen/cuda/arith.cpp",
    "torch/csrc/jit/codegen/cuda/compute_at.cpp",
    "torch/csrc/jit/codegen/cuda/codegen.cpp",
    "torch/csrc/jit/codegen/cuda/dispatch.cpp",
    "torch/csrc/jit/codegen/cuda/expr_evaluator.cpp",
    "torch/csrc/jit/codegen/cuda/executor.cpp",
    "torch/csrc/jit/codegen/cuda/executor_kernel_arg.cpp",
    "torch/csrc/jit/codegen/cuda/executor_launch_params.cpp",
    "torch/csrc/jit/codegen/cuda/executor_utils.cpp",
    "torch/csrc/jit/codegen/cuda/fusion.cpp",
    "torch/csrc/jit/codegen/cuda/graph_fuser.cpp",
    "torch/csrc/jit/codegen/cuda/index_compute.cpp",
    "torch/csrc/jit/codegen/cuda/instrumentation.cpp",
    "torch/csrc/jit/codegen/cuda/ir_base_nodes.cpp",
    "torch/csrc/jit/codegen/cuda/ir_cloner.cpp",
    "torch/csrc/jit/codegen/cuda/ir_graphviz.cpp",
    "torch/csrc/jit/codegen/cuda/ir_nodes.cpp",
    "torch/csrc/jit/codegen/cuda/ir_iostream.cpp",
    "torch/csrc/jit/codegen/cuda/iter_visitor.cpp",
    "torch/csrc/jit/codegen/cuda/kernel.cpp",
    "torch/csrc/jit/codegen/cuda/kernel_cache.cpp",
    "torch/csrc/jit/codegen/cuda/kernel_ir.cpp",
    "torch/csrc/jit/codegen/cuda/kernel_ir_builder.cpp",
    "torch/csrc/jit/codegen/cuda/kernel_ir_printer.cpp",
    "torch/csrc/jit/codegen/cuda/lower_index.cpp",
    "torch/csrc/jit/codegen/cuda/lower_loops.cpp",
    "torch/csrc/jit/codegen/cuda/lower_alias_memory.cpp",
    "torch/csrc/jit/codegen/cuda/lower_insert_syncs.cpp",
    "torch/csrc/jit/codegen/cuda/lower_unroll.cpp",
    "torch/csrc/jit/codegen/cuda/lower_thread_predicate.cpp",
    "torch/csrc/jit/codegen/cuda/lower_utils.cpp",
    "torch/csrc/jit/codegen/cuda/lower_validation.cpp",
    "torch/csrc/jit/codegen/cuda/lower2device.cpp",
    "torch/csrc/jit/codegen/cuda/manager.cpp",
    "torch/csrc/jit/codegen/cuda/mutator.cpp",
    "torch/csrc/jit/codegen/cuda/parser.cpp",
    "torch/csrc/jit/codegen/cuda/partition.cpp",
    "torch/csrc/jit/codegen/cuda/predicate_compute.cpp",
    "torch/csrc/jit/codegen/cuda/register_interface.cpp",
    "torch/csrc/jit/codegen/cuda/scheduler.cpp",
    "torch/csrc/jit/codegen/cuda/shape_inference.cpp",
    "torch/csrc/jit/codegen/cuda/tensor_view.cpp",
    "torch/csrc/jit/codegen/cuda/transform_iter.cpp",
    "torch/csrc/jit/codegen/cuda/transform_replay.cpp",
    "torch/csrc/jit/codegen/cuda/transform_rfactor.cpp",
    "torch/csrc/jit/codegen/cuda/type.cpp",
    "torch/csrc/jit/tensorexpr/cuda_codegen.cpp",
    "torch/csrc/jit/runtime/register_cuda_ops.cpp",
]

libtorch_cuda_sources = libtorch_cuda_core_sources + [
    "torch/csrc/cuda/nccl.cpp",
]

torch_cpp_srcs = [
    "torch/csrc/api/src/cuda.cpp",  # this just forwards stuff, no real CUDA
    "torch/csrc/api/src/data/datasets/mnist.cpp",
    "torch/csrc/api/src/data/samplers/distributed.cpp",
    "torch/csrc/api/src/data/samplers/random.cpp",
    "torch/csrc/api/src/data/samplers/sequential.cpp",
    "torch/csrc/api/src/data/samplers/stream.cpp",
    "torch/csrc/api/src/enum.cpp",
    "torch/csrc/api/src/jit.cpp",
    "torch/csrc/api/src/serialize.cpp",
    "torch/csrc/api/src/nn/init.cpp",
    "torch/csrc/api/src/nn/module.cpp",
    "torch/csrc/api/src/nn/modules/_functions.cpp",
    "torch/csrc/api/src/nn/modules/activation.cpp",
    "torch/csrc/api/src/nn/modules/adaptive.cpp",
    "torch/csrc/api/src/nn/modules/batchnorm.cpp",
    "torch/csrc/api/src/nn/modules/normalization.cpp",
    "torch/csrc/api/src/nn/modules/instancenorm.cpp",
    "torch/csrc/api/src/nn/modules/conv.cpp",
    "torch/csrc/api/src/nn/modules/dropout.cpp",
    "torch/csrc/api/src/nn/modules/distance.cpp",
    "torch/csrc/api/src/nn/modules/embedding.cpp",
    "torch/csrc/api/src/nn/modules/fold.cpp",
    "torch/csrc/api/src/nn/modules/linear.cpp",
    "torch/csrc/api/src/nn/modules/loss.cpp",
    "torch/csrc/api/src/nn/modules/padding.cpp",
    "torch/csrc/api/src/nn/modules/pixelshuffle.cpp",
    "torch/csrc/api/src/nn/modules/pooling.cpp",
    "torch/csrc/api/src/nn/modules/rnn.cpp",
    "torch/csrc/api/src/nn/modules/upsampling.cpp",
    "torch/csrc/api/src/nn/modules/transformer.cpp",
    "torch/csrc/api/src/nn/modules/container/functional.cpp",
    "torch/csrc/api/src/nn/options/activation.cpp",
    "torch/csrc/api/src/nn/options/adaptive.cpp",
    "torch/csrc/api/src/nn/options/batchnorm.cpp",
    "torch/csrc/api/src/nn/options/conv.cpp",
    "torch/csrc/api/src/nn/options/dropout.cpp",
    "torch/csrc/api/src/nn/options/instancenorm.cpp",
    "torch/csrc/api/src/nn/options/linear.cpp",
    "torch/csrc/api/src/nn/options/normalization.cpp",
    "torch/csrc/api/src/nn/options/embedding.cpp",
    "torch/csrc/api/src/nn/options/padding.cpp",
    "torch/csrc/api/src/nn/options/pooling.cpp",
    "torch/csrc/api/src/nn/options/rnn.cpp",
    "torch/csrc/api/src/nn/options/vision.cpp",
    "torch/csrc/api/src/nn/options/transformer.cpp",
    "torch/csrc/api/src/optim/adagrad.cpp",
    "torch/csrc/api/src/optim/adam.cpp",
    "torch/csrc/api/src/optim/adamw.cpp",
    "torch/csrc/api/src/optim/lbfgs.cpp",
    "torch/csrc/api/src/optim/optimizer.cpp",
    "torch/csrc/api/src/optim/rmsprop.cpp",
    "torch/csrc/api/src/optim/serialize.cpp",
    "torch/csrc/api/src/optim/sgd.cpp",
    "torch/csrc/api/src/serialize/input-archive.cpp",
    "torch/csrc/api/src/serialize/output-archive.cpp",
]

libtorch_python_cuda_core_sources = [
    "torch/csrc/cuda/Event.cpp",
    "torch/csrc/cuda/Module.cpp",
    "torch/csrc/cuda/python_comm.cpp",
    "torch/csrc/cuda/Storage.cpp",
    "torch/csrc/cuda/Stream.cpp",
    "torch/csrc/cuda/Graph.cpp",
    "torch/csrc/cuda/serialization.cpp",
    "torch/csrc/cuda/shared/cudart.cpp",
    "torch/csrc/cuda/shared/nvtx.cpp",
    "torch/csrc/cuda/utils.cpp",
]

libtorch_python_cuda_sources = libtorch_python_cuda_core_sources + [
    "torch/csrc/cuda/python_nccl.cpp",
    "torch/csrc/cuda/shared/cudnn.cpp",
    "torch/csrc/cuda/Tensor.cpp",
]

libtorch_python_core_sources = [
    "torch/csrc/DataLoader.cpp",
    "torch/csrc/Device.cpp",
    "torch/csrc/Dtype.cpp",
    "torch/csrc/DynamicTypes.cpp",
    "torch/csrc/Exceptions.cpp",
    "torch/csrc/Generator.cpp",
    "torch/csrc/Layout.cpp",
    "torch/csrc/MemoryFormat.cpp",
    "torch/csrc/QScheme.cpp",
    "torch/csrc/Module.cpp",
    "torch/csrc/python_dimname.cpp",
    "torch/csrc/Size.cpp",
    "torch/csrc/Storage.cpp",
    "torch/csrc/Stream.cpp",
    "torch/csrc/TypeInfo.cpp",
    "torch/csrc/api/src/python/init.cpp",
    "torch/csrc/autograd/functions/init.cpp",
    "torch/csrc/autograd/init.cpp",
    "torch/csrc/autograd/python_anomaly_mode.cpp",
    "torch/csrc/autograd/python_cpp_function.cpp",
    "torch/csrc/autograd/python_engine.cpp",
    "torch/csrc/autograd/python_function.cpp",
    "torch/csrc/autograd/python_hook.cpp",
    "torch/csrc/autograd/python_legacy_variable.cpp",
    "torch/csrc/autograd/python_variable.cpp",
    "torch/csrc/autograd/python_variable_indexing.cpp",
    "torch/csrc/jit/backends/backend_init.cpp",
    "torch/csrc/jit/backends/backend_resolver.cpp",
    "torch/csrc/jit/python/init.cpp",
    "torch/csrc/jit/passes/onnx.cpp",
    "torch/csrc/jit/passes/onnx/cast_all_constant_to_floating.cpp",
    "torch/csrc/jit/passes/onnx/eval_peephole.cpp",
    "torch/csrc/jit/passes/onnx/constant_fold.cpp",
    "torch/csrc/jit/passes/onnx/eliminate_unused_items.cpp",
    "torch/csrc/jit/passes/onnx/fixup_onnx_controlflow.cpp",
    "torch/csrc/jit/passes/onnx/list_model_parameters.cpp",
    "torch/csrc/jit/passes/onnx/function_substitution.cpp",
    "torch/csrc/jit/passes/onnx/fold_if_node.cpp",
    "torch/csrc/jit/passes/onnx/helper.cpp",
    "torch/csrc/jit/passes/onnx/peephole.cpp",
    "torch/csrc/jit/passes/onnx/preprocess_for_onnx.cpp",
    "torch/csrc/jit/passes/onnx/prepare_division_for_onnx.cpp",
    "torch/csrc/jit/passes/onnx/scalar_type_analysis.cpp",
    "torch/csrc/jit/passes/onnx/unpack_quantized_weights.cpp",
    "torch/csrc/jit/passes/onnx/remove_inplace_ops_for_onnx.cpp",
    "torch/csrc/jit/passes/onnx/shape_type_inference.cpp",
    "torch/csrc/jit/python/pybind_utils.cpp",
    "torch/csrc/jit/python/python_arg_flatten.cpp",
    "torch/csrc/jit/python/python_custom_class.cpp",
    "torch/csrc/jit/python/python_interpreter.cpp",
    "torch/csrc/jit/python/python_ir.cpp",
    "torch/csrc/jit/python/python_tracer.cpp",
    "torch/csrc/jit/python/script_init.cpp",
    "torch/csrc/jit/frontend/concrete_module_type.cpp",
    "torch/csrc/jit/python/python_sugared_value.cpp",
    "torch/csrc/jit/python/python_tree_views.cpp",
    "torch/csrc/jit/runtime/static/init.cpp",
    "torch/csrc/jit/tensorexpr/tensorexpr_init.cpp",
    "torch/csrc/multiprocessing/init.cpp",
    "torch/csrc/onnx/init.cpp",
    "torch/csrc/serialization.cpp",
    "torch/csrc/tensor/python_tensor.cpp",
    "torch/csrc/utils/init.cpp",
    "torch/csrc/utils/throughput_benchmark.cpp",
    "torch/csrc/utils.cpp",
    "torch/csrc/utils/cuda_lazy_init.cpp",
    "torch/csrc/utils/invalid_arguments.cpp",
    "torch/csrc/utils/object_ptr.cpp",
    "torch/csrc/utils/python_arg_parser.cpp",
    "torch/csrc/utils/python_dispatch.cpp",
    "torch/csrc/utils/structseq.cpp",
    "torch/csrc/utils/tensor_apply.cpp",
    "torch/csrc/utils/tensor_dtypes.cpp",
    "torch/csrc/utils/tensor_layouts.cpp",
    "torch/csrc/utils/tensor_memoryformats.cpp",
    "torch/csrc/utils/tensor_qschemes.cpp",
    "torch/csrc/utils/tensor_list.cpp",
    "torch/csrc/utils/tensor_new.cpp",
    "torch/csrc/utils/tensor_numpy.cpp",
    "torch/csrc/utils/tensor_types.cpp",
    "torch/csrc/utils/disable_torch_function.cpp",
]

libtorch_python_distributed_core_sources = [
    "torch/lib/c10d/comm.cpp",
    "torch/lib/c10d/default_comm_hooks.cpp",
    "torch/lib/c10d/frontend.cpp",
    "torch/lib/c10d/reducer.cpp",
    "torch/csrc/distributed/c10d/python_comm_hook.cpp",
    "torch/csrc/distributed/c10d/init.cpp",
]

libtorch_python_distributed_sources = libtorch_python_distributed_core_sources + [
    "torch/csrc/distributed/autograd/init.cpp",
    "torch/csrc/distributed/rpc/init.cpp",
    "torch/csrc/distributed/rpc/process_group_agent.cpp",
    "torch/csrc/distributed/rpc/py_rref.cpp",
    "torch/csrc/distributed/rpc/python_functions.cpp",
    "torch/csrc/distributed/rpc/python_rpc_handler.cpp",
    "torch/csrc/distributed/rpc/request_callback_impl.cpp",
    "torch/csrc/distributed/rpc/tensorpipe_agent.cpp",
    "torch/csrc/distributed/rpc/tensorpipe_utils.cpp",
    "torch/csrc/distributed/rpc/testing/faulty_process_group_agent.cpp",
    "torch/csrc/distributed/rpc/testing/init.cpp",
    "torch/csrc/distributed/rpc/unpickled_python_call.cpp",
    "torch/csrc/distributed/rpc/unpickled_python_remote_call.cpp",
    "torch/csrc/jit/runtime/register_distributed_ops.cpp",
]

def glob_libtorch_python_sources(gencode_pattern = ":generate-code[{}]"):
    _libtorch_python_sources = [gencode_pattern.format(name) for name in [
        "autograd/generated/python_functions.cpp",
        "autograd/generated/python_nn_functions.cpp",
        "autograd/generated/python_fft_functions.cpp",
        "autograd/generated/python_linalg_functions.cpp",
        "autograd/generated/python_torch_functions.cpp",
        "autograd/generated/python_variable_methods.cpp",
    ]]

    _libtorch_python_sources.extend(libtorch_python_core_sources)
    _libtorch_python_sources.extend(libtorch_python_distributed_sources)

    return _libtorch_python_sources
